(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-sharing-order-comment-comment"],{"1d00":function(e,t,o){"use strict";var i=o("6393"),a=o.n(i);a.a},2651:function(e,t,o){"use strict";var i,a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.goodsList.length&&e.formData.length?o("v-uni-view",{staticClass:"container p-bottom"},[o("v-uni-view",{staticClass:"goods-list"},e._l(e.goodsList,(function(t,i){return o("v-uni-view",{key:i,staticClass:"goods-item"},[o("v-uni-view",{staticClass:"goods-detail dis-flex flex-dir-row"},[o("v-uni-view",{staticClass:"left"},[o("v-uni-image",{staticClass:"goods-image",attrs:{src:t.image.file_path}})],1),o("v-uni-view",{staticClass:"right dis-flex flex-box flex-dir-column flex-x-around"},[o("v-uni-text",{staticClass:"twolist-hidden"},[e._v(e._s(t.goods_name))]),o("v-uni-text",{},[e._v("￥"+e._s(t.goods_price))])],1)],1),o("v-uni-view",{staticClass:"score-row dis-flex flex-x-around"},[o("v-uni-view",{class:"score-item score__praise dis-flex flex-y-center flex-x-center "+(10==e.formData[i].score?"__active":""),attrs:{"data-index":i,"data-score":"10"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.setScore.apply(void 0,arguments)}}},[o("v-uni-view",{staticClass:"score"},[o("v-uni-text",{staticClass:"score__icon iconfont icon-haoping"}),o("v-uni-text",{staticClass:"score__text"},[e._v("好评")])],1)],1),o("v-uni-view",{class:"score-item score__review dis-flex flex-y-center flex-x-center "+(20==e.formData[i].score?"__active":""),attrs:{"data-index":i,"data-score":"20"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.setScore.apply(void 0,arguments)}}},[o("v-uni-view",{staticClass:"score"},[o("v-uni-text",{staticClass:"score__icon iconfont icon-zhongping"}),o("v-uni-text",{staticClass:"score__text"},[e._v("中评")])],1)],1),o("v-uni-view",{class:"score-item score__negative dis-flex flex-y-center flex-x-center "+(30==e.formData[i].score?"__active":""),attrs:{"data-index":i,"data-score":"30"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.setScore.apply(void 0,arguments)}}},[o("v-uni-view",{staticClass:"score"},[o("v-uni-text",{staticClass:"score__icon iconfont icon-chaping"}),o("v-uni-text",{staticClass:"score__text"},[e._v("差评")])],1)],1)],1),o("v-uni-view",{staticClass:"dis-flex content-row"},[o("v-uni-textarea",{attrs:{"data-index":i,maxlength:"2000",placeholder:"请输入评价内容 (留空则不评价)",placeholderStyle:"color:#ccc"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.contentInput.apply(void 0,arguments)}}})],1),o("v-uni-view",{staticClass:"image-list"},[e._l(e.formData[i].image_list,(function(t,a){return o("v-uni-view",{key:a,staticClass:"image-preview"},[o("v-uni-text",{staticClass:"image-delete iconfont icon-shanchu",attrs:{"data-index":i,"data-image-index":a},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.deleteImage.apply(void 0,arguments)}}}),o("v-uni-image",{attrs:{mode:"aspectFill",src:t}})],1)})),!e.formData[i].image_list||e.formData[i].image_list.length<6?o("v-uni-view",{staticClass:"image-picker dis-flex flex-dir-column flex-x-center flex-y-center",attrs:{"data-index":i},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseImage.apply(void 0,arguments)}}},[o("v-uni-text",{staticClass:"choose__icon iconfont icon-tubiao_xiangji"}),o("v-uni-text",{staticClass:"choose__text"},[e._v("上传图片")])],1):e._e()],2)],1)})),1),o("v-uni-view",{staticClass:"flow-fixed-footer b-f"},[o("v-uni-view",{staticClass:"flow-btn f-32"},[o("v-uni-view",{on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v("确认提交")])],1)],1)],1):e._e()},s=[];o.d(t,"b",(function(){return a})),o.d(t,"c",(function(){return s})),o.d(t,"a",(function(){return i}))},"3aad":function(e,t,o){"use strict";var i=o("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,o("28a5"),o("456d");var a=i(o("7618")),s=i(o("bd86"));o("ac6a");var c=getApp().globalData,n={components:{},props:{},data:function(){return{options:null,goodsList:[],formData:[]}},onLoad:function(e){this.options=e,this.getGoodsList()},methods:{getGoodsList:function(){var e=this;c._get("sharing.comment/order",{order_id:this.options.order_id},(function(t){var o=t.data.goodsList;e.setData({goodsList:o,formData:e.initFormData(o)})}))},initFormData:function(e){var t=[];return e.forEach((function(e){t.push({goods_id:e.goods_id,order_goods_id:e.order_goods_id,score:10,content:"",image_list:[],uploaded:[]})})),t},setScore:function(e){var t=e.currentTarget.dataset;this.setData((0,s.default)({},"formData."+t.index+".score",t.score))},contentInput:function(e){var t=e.currentTarget.dataset.index;this.setData((0,s.default)({},"formData."+t+".content",e.detail.value))},chooseImage:function(e){var t=this,o=e.currentTarget.dataset.index,i=t.formData[o].image_list;uni.chooseImage({count:6-i.length,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){t.setData((0,s.default)({},"formData."+o+".image_list",i.concat(e.tempFilePaths)))}})},deleteImage:function(e){var t=e.currentTarget.dataset,o=this.formData[t.index].image_list;o.splice(t.imageIndex,1),this.setData((0,s.default)({},"formData."+t.index+".image_list",o))},submit:function(){var e=this,t=e.formData;if(!0===e.submitDisable)return!1;e.submitDisable=!0,uni.showLoading({title:"正在处理...",mask:!0});var o=function(t){console.log("fromPostCall"),console.log(t),c._post_form("sharing.comment/order",{order_id:e.options.order_id,formData:JSON.stringify(t)},(function(e){1===e.code?c.showSuccess(e.msg,(function(){uni.navigateBack()})):c.showError(e.msg)}),!1,(function(){uni.hideLoading(),e.submitDisable=!1}))},i=0;t.forEach((function(e){""!==e.content&&(i+=e.image_list.length)})),i>0?e.uploadFile(i,t,o):o(t)},uploadFile:function(e,t,o){var i={wxapp_id:c.getWxappId(),token:uni.getStorageSync("token")},s=0;t.forEach((function(n){""!==n.content&&n.image_list.forEach((function(r,d){uni.uploadFile({url:c.api_root+"upload/image",filePath:r,name:"iFile",formData:i,success:function(e){var t="object"===(0,a.default)(e.data)?e.data:JSON.parse(e.data);1===t.code&&(n.uploaded[d]=t.data.file_id)},complete:function(){s++,e===s&&(console.log("upload complete"),o&&o(t))}})}))}))},setData:function(e){var t,o,i=this,a=[];Object.keys(e).forEach((function(s){a=s.split("."),t=e[s],o=i.$data,a.forEach((function(e,s){console.log(e),s+1===a.length?i.$set(o,e,t):o[e]||i.$set(o,e,{}),o=o[e]}))}))}}};t.default=n},4117:function(e,t,o){t=e.exports=o("2350")(!1),t.push([e.i,'.goods-list[data-v-4e74c7ef]{border-top:%?1?% solid #e3e3e3;font-size:%?28?%}.goods-item[data-v-4e74c7ef]{margin-bottom:%?30?%;border-bottom:%?1?% solid #e3e3e3;background:#fff}.goods-item .goods-detail[data-v-4e74c7ef]{padding:%?24?% %?20?%}.goods-item .goods-detail .left .goods-image[data-v-4e74c7ef]{display:block;width:%?150?%;height:%?150?%}.goods-item .goods-detail .right[data-v-4e74c7ef]{padding-left:%?20?%}.goods-item .score-row[data-v-4e74c7ef]{padding:%?24?% %?20?%}.goods-item .score-row .score-item.score__praise[data-v-4e74c7ef]{color:#ff4544}.goods-item .score-row .score-item.score__praise .score__icon[data-v-4e74c7ef]{background:#ff4544}.goods-item .score-row .score-item.score__review[data-v-4e74c7ef]{color:#fcb500}.goods-item .score-row .score-item.score__review .score__icon[data-v-4e74c7ef]{background:#fcb500}.goods-item .score-row .score-item.score__negative[data-v-4e74c7ef]{color:#9b9b9b}.goods-item .score-row .score-item.score__negative .score__icon[data-v-4e74c7ef]{background:#9b9b9b}.goods-item .score-row .score-item .score[data-v-4e74c7ef]{padding:%?10?% %?20?% %?10?% %?10?%;border-radius:%?30?%}.goods-item .score-row .score-item .score .score__icon[data-v-4e74c7ef]{margin-right:%?10?%;padding:%?10?%;border-radius:50%;font-size:%?30?%;color:#fff}.goods-item .score-row .score-item.__active .score[data-v-4e74c7ef]{color:#fff}.goods-item .score-row .score-item.__active.score__praise .score[data-v-4e74c7ef]{background:#ff4544}.goods-item .score-row .score-item.__active.score__review .score[data-v-4e74c7ef]{background:#fcb500}.goods-item .score-row .score-item.__active.score__negative .score[data-v-4e74c7ef]{background:#9b9b9b}.goods-item .content-row[data-v-4e74c7ef]{padding:%?10?% %?20?%}.goods-item .content-row uni-textarea[data-v-4e74c7ef]{width:100%;height:%?220?%;padding:%?12?%;border:%?1?% solid #e8e8e8;border-radius:%?5?%;box-sizing:border-box}.goods-item .image-list[data-v-4e74c7ef]{padding:%?24?% %?20?%}.goods-item .image-list[data-v-4e74c7ef]:after{clear:both;content:" ";display:table}.goods-item .image-list uni-image[data-v-4e74c7ef]{display:block;width:%?150?%;height:%?150?%}.goods-item .image-list .image-picker[data-v-4e74c7ef]{width:%?150?%;height:%?150?%;border:%?1?% dashed #ccc;color:#ccc}.goods-item .image-list .image-picker .choose__icon[data-v-4e74c7ef]{font-size:%?56?%;margin-bottom:%?6?%}.goods-item .image-list .image-picker .choose__text[data-v-4e74c7ef]{font-size:%?22?%}.goods-item .image-list .image-picker[data-v-4e74c7ef], .goods-item .image-list .image-preview[data-v-4e74c7ef]{margin-right:%?30?%;margin-top:%?30?%;float:left}.goods-item .image-list .image-picker[data-v-4e74c7ef]:nth-child(4n+0), .goods-item .image-list .image-preview[data-v-4e74c7ef]:nth-child(4n+0){margin-right:0}.goods-item .image-list .image-preview[data-v-4e74c7ef]{position:relative}.goods-item .image-list .image-preview .image-delete[data-v-4e74c7ef]{position:absolute;top:%?-15?%;right:%?-15?%;height:%?42?%;width:%?42?%;line-height:%?42?%;background:rgba(0,0,0,.64);border-radius:50%;color:#fff;font-weight:bolder;font-size:%?22?%;z-index:10;text-align:center}',""])},6393:function(e,t,o){var i=o("4117");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var a=o("4f06").default;a("0d86b35c",i,!0,{sourceMap:!1,shadowMode:!1})},6644:function(e,t,o){"use strict";o.r(t);var i=o("3aad"),a=o.n(i);for(var s in i)"default"!==s&&function(e){o.d(t,e,(function(){return i[e]}))}(s);t["default"]=a.a},"6ef7":function(e,t,o){"use strict";o.r(t);var i=o("2651"),a=o("6644");for(var s in a)"default"!==s&&function(e){o.d(t,e,(function(){return a[e]}))}(s);o("1d00");var c,n=o("f0c5"),r=Object(n["a"])(a["default"],i["b"],i["c"],!1,null,"4e74c7ef",null,!1,i["a"],c);t["default"]=r.exports}}]);