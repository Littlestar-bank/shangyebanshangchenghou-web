(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-dealer-apply-apply"],{"30df":function(e,t,i){"use strict";i.r(t);var a=i("68ee"),n=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t["default"]=n.a},"68ee":function(e,t,i){"use strict";var a=i("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("96cf");var n=a(i("53ca")),o=a(i("1da1"));i("a15b"),i("1276"),i("ac1f"),i("99af"),i("a434"),i("d3b7"),i("4160"),i("159b"),i("b64b");var s=a(i("2544")),r=a(i("7740")),l=a(i("bf46")),c=getApp().globalData,u={components:{mpvueCityPicker:s.default,zanDialog:l.default},props:{},data:function(){return{is_read:!1,disabled:!1,region:[],mpVueTmpRegion:[],mpVueRegion:[0,0,0],mpVueInit:!0,submsgSetting:{},is_dealer:null,is_applying:null,referee_name:null,background:null,words:null,license:null,isData:null,name:null,mobile:null,detail:null,imageList:[],imageList2:[]}},computed:{regionStr:function(){return Array.isArray(this.region)?this.region.join(","):""}},onLoad:function(){var e=this;e.getSubmsgSetting()},onShow:function(){this.getApplyState()},methods:{onConfirm:function(){this.region=0===this.mpVueTmpRegion.length?["北京市","市辖区","东城区"]:this.mpVueTmpRegion},bindRegionChange:function(e){this.setData({region:e.detail.value})},bindRegionChangeH5:function(e){this.mpVueTmpRegion=e.label&&e.label.split("-")||[]},getSubmsgSetting:function(){var e=this;c._get("wxapp.submsg/setting",{},(function(t){e.setData({submsgSetting:t.data.setting})}))},getApplyState:function(){var e=this;c._get("user.dealer/apply",{referee_id:e.getRefereeid()},(function(t){var i=t.data;i.is_dealer&&uni.redirectTo({url:"../index/index"}),uni.setNavigationBarTitle({title:i.words.apply.title.value}),i.isData=!0,e.setData(i)}))},toggleApplyLicense:function(){(0,r.default)({title:"申请协议",message:this.license,selector:"#zan-base-dialog",isScroll:!0,buttons:[{text:"我已阅读",color:"red",type:"cash"}]}).then((function(){}))},toggleSetRead:function(){this.setData({is_read:!this.is_read})},onFormSubmit:function(e){var t=this;return(0,o.default)(regeneratorRuntime.mark((function i(){var a,n,o,s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(a=t,n=e.detail.value,console.log(n),n.name&&!(n.name.length<1)){i.next=5;break}return c.showError("请填写姓名"),i.abrupt("return",!1);case 5:if(/^\+?\d[\d -]{8,12}\d/.test(n.mobile)){i.next=8;break}return c.showError("手机号格式不正确"),i.abrupt("return",!1);case 8:if(""!==t.regionStr){i.next=11;break}return c.showError("请选择城市"),i.abrupt("return",!1);case 11:if(n.detail&&!(n.detail.length<1)){i.next=14;break}return c.showError("请填写详细地址"),i.abrupt("return",!1);case 14:if(0!==t.imageList.length){i.next=17;break}return c.showError("请上传门头图片"),i.abrupt("return",!1);case 17:if(0!==t.imageList2.length){i.next=20;break}return c.showError("请上传营业执照"),i.abrupt("return",!1);case 20:if(a.is_read){i.next=23;break}return c.showError("请先阅读分销商申请协议"),i.abrupt("return",!1);case 23:if(a.setData({disabled:!0}),!(a.imageList.length>0)){i.next=28;break}return i.next=27,t.uploadFile(a.imageList);case 27:o=i.sent;case 28:if(!(a.imageList2.length>0)){i.next=32;break}return i.next=31,t.uploadFile(a.imageList2);case 31:s=i.sent;case 32:n.region=t.regionStr,n.door_image=o[0],n.trading_image=s[0],c._post_form("user.dealer.apply/submit",n,(function(){a.getApplyState()}),null,(function(){a.setData({disabled:!1})}));case 36:case"end":return i.stop()}}),i)})))()},chooseImage:function(e){var t=this,i=t.imageList;c.saveFormId(e.detail.formId),uni.chooseImage({count:1-i.length,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){t.setData({imageList:i.concat(e.tempFilePaths)})}})},chooseImage2:function(e){var t=this,i=t.imageList2;c.saveFormId(e.detail.formId),uni.chooseImage({count:1-i.length,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){t.setData({imageList2:i.concat(e.tempFilePaths)})}})},deleteImage:function(e){var t=e.currentTarget.dataset,i=this.imageList;i.splice(t.imageIndex,1),this.setData({imageList:i})},deleteImage2:function(e){var t=e.currentTarget.dataset,i=this.imageList;i.splice(t.imageIndex,1),this.setData({imageList:i})},uploadFile:function(e){var t=e.length,i=[];return new Promise((function(a){var o=0;e.forEach((function(e,s){uni.uploadFile({url:c.api_root+"upload/image",filePath:e,name:"iFile",formData:{wxapp_id:c.getWxappId(),token:uni.getStorageSync("token")},success:function(e){var t="object"===(0,n.default)(e.data)?e.data:JSON.parse(e.data);1===t.code&&(i[s]=t.data.file_id)},complete:function(){o++,t===o&&(console.log("upload complete"),a(i))}})}))}))},navigationToIndex:function(){uni.switchTab({url:"/pages/index/index"})},onSubMsg:function(){var e=this,t=e.submsgSetting.dealer.apply.template_id;t.length>0&&uni.requestSubscribeMessage({tmplIds:[t],success:function(){},fail:function(){},complete:function(){}})},getRefereeid:function(){return uni.getStorageSync("referee_id")},setData:function(e){var t,i,a=this,n=[];Object.keys(e).forEach((function(o){n=o.split("."),t=e[o],i=a.$data,n.forEach((function(e,o){console.log(e),o+1===n.length?a.$set(i,e,t):i[e]||a.$set(i,e,{}),i=i[e]}))}))}}};t.default=u},"7db05":function(e,t,i){"use strict";var a;i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return a}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.isData?i("v-uni-view",{staticClass:"container"},[i("v-uni-view",{staticClass:"dealer-bg"},[i("v-uni-image",{attrs:{mode:"widthFix",src:e.background}})],1),e.is_applying?e._e():[i("v-uni-view",{staticClass:"dis-flex flex-dir-column flex-y-center"},[i("v-uni-view",{staticClass:"widget-form b-f m-top20 dis-flex flex-dir-column"},[i("v-uni-view",{staticClass:"form-title f-30"},[e._v(e._s(e.words.apply.words.title.value))]),i("v-uni-view",{staticClass:"form-box dis-flex flex-dir-column"},[i("v-uni-form",{attrs:{"report-submit":"true"},on:{submit:function(t){arguments[0]=t=e.$handleEvent(t),e.onFormSubmit.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"form-field dis-flex flex-y-center"},[i("v-uni-view",{staticClass:"field-label"},[e._v("邀请人")]),i("v-uni-view",{staticClass:"field-input"},[i("v-uni-text",[e._v(e._s(e.referee_name)+"（请核对）")])],1)],1),i("v-uni-view",{staticClass:"form-field dis-flex flex-y-center"},[i("v-uni-view",{staticClass:"field-label"},[e._v("姓名")]),i("v-uni-view",{staticClass:"field-input flex-box"},[i("v-uni-input",{attrs:{name:"name",placeholder:"请输入真实姓名",value:e.name}})],1)],1),i("v-uni-view",{staticClass:"form-field dis-flex flex-y-center"},[i("v-uni-view",{staticClass:"field-label"},[e._v("手机号")]),i("v-uni-view",{staticClass:"field-input flex-box"},[i("v-uni-input",{attrs:{name:"mobile",placeholder:"请输入手机号",value:e.mobile}})],1)],1),i("v-uni-view",{staticClass:"form-field dis-flex flex-y-center"},[i("v-uni-view",{staticClass:"field-label"},[e._v("城市")]),i("v-uni-view",{staticClass:"field-input flex-box"},[e.mpVueInit?i("mpvue-city-picker",{ref:"mpvueCityPicker",attrs:{pickerValueDefault:e.mpVueRegion},on:{onChange:function(t){arguments[0]=t=e.$handleEvent(t),e.bindRegionChangeH5.apply(void 0,arguments)},onCancel:function(t){arguments[0]=t=e.$handleEvent(t),function(){}.apply(void 0,arguments)},onConfirm:function(t){arguments[0]=t=e.$handleEvent(t),e.onConfirm.apply(void 0,arguments)}}}):e._e(),e.region.length?i("v-uni-text",{staticClass:"f-30",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.$refs.mpvueCityPicker.show()}}},[e._v(e._s(e.regionStr))]):i("v-uni-text",{staticClass:"f-30 col-7",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.$refs.mpvueCityPicker.show()}}},[e._v("选择省、市、区")])],1)],1),i("v-uni-view",{staticClass:"form-field dis-flex flex-y-center"},[i("v-uni-view",{staticClass:"field-label"},[e._v("详细地址")]),i("v-uni-view",{staticClass:"field-input flex-box"},[i("v-uni-input",{attrs:{name:"detail",placeholder:"请输入详细地址",value:e.detail}})],1)],1),i("v-uni-view",{staticClass:"form-field dis-flex flex-y-center auto-height"},[i("v-uni-view",{staticClass:"field-label"},[e._v("门头照片")]),i("v-uni-view",{staticClass:"field-input flex-box"},[i("v-uni-view",{staticClass:"row-voucher"},[i("v-uni-view",{staticClass:"image-list"},[e._l(e.imageList,(function(t,a){return i("v-uni-view",{key:a,staticClass:"image-preview"},[i("v-uni-text",{staticClass:"image-delete iconfont icon-shanchu",attrs:{"data-image-index":a},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.deleteImage.apply(void 0,arguments)}}}),i("v-uni-image",{attrs:{mode:"aspectFill",src:t}})],1)})),e.imageList.length<1?i("v-uni-form",{attrs:{"report-submit":"true"},on:{submit:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseImage.apply(void 0,arguments)}}},[i("v-uni-button",{staticClass:"btn-normal",attrs:{formType:"submit"}},[i("v-uni-view",{staticClass:"image-picker dis-flex flex-dir-column flex-x-center flex-y-center"},[i("v-uni-text",{staticClass:"choose__icon iconfont icon-tubiao_xiangji"}),i("v-uni-text",{staticClass:"choose__text"},[e._v("上传图片")])],1)],1)],1):e._e()],2)],1)],1)],1),i("v-uni-view",{staticClass:"form-field dis-flex flex-y-center auto-height"},[i("v-uni-view",{staticClass:"field-label"},[e._v("营业执照")]),i("v-uni-view",{staticClass:"field-input flex-box"},[i("v-uni-view",{staticClass:"row-voucher"},[i("v-uni-view",{staticClass:"image-list"},[e._l(e.imageList2,(function(t,a){return i("v-uni-view",{key:a,staticClass:"image-preview"},[i("v-uni-text",{staticClass:"image-delete iconfont icon-shanchu",attrs:{"data-image-index":a},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.deleteImage2.apply(void 0,arguments)}}}),i("v-uni-image",{attrs:{mode:"aspectFill",src:t}})],1)})),e.imageList2.length<1?i("v-uni-form",{attrs:{"report-submit":"true"},on:{submit:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseImage2.apply(void 0,arguments)}}},[i("v-uni-button",{staticClass:"btn-normal",attrs:{formType:"submit"}},[i("v-uni-view",{staticClass:"image-picker dis-flex flex-dir-column flex-x-center flex-y-center"},[i("v-uni-text",{staticClass:"choose__icon iconfont icon-tubiao_xiangji"}),i("v-uni-text",{staticClass:"choose__text"},[e._v("上传图片")])],1)],1)],1):e._e()],2)],1)],1)],1),i("v-uni-view",{staticClass:"form-license dis-flex flex-x-center flex-y-center"},[i("v-uni-view",{staticClass:"license-radio dis-flex flex-y-center",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.toggleSetRead.apply(void 0,arguments)}}},[i("v-uni-text",{class:"license-icon  "+(e.is_read?"c-violet":"col-bb")+" f-38 iconfont icon-radio"}),i("v-uni-text",{staticClass:"f-28 col-80"},[e._v("我已阅读并了解")])],1),i("v-uni-text",{staticClass:"f-28 c-violet",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.toggleApplyLicense.apply(void 0,arguments)}}},[e._v("【"+e._s(e.words.apply.words.license.value)+"】")])],1),i("v-uni-view",{staticClass:"form-submit dis-flex flex-x-center"},[i("v-uni-button",{attrs:{formType:"submit",disabled:e.disabled}},[e._v(e._s(e.words.apply.words.submit.value))])],1)],1)],1)],1)],1),i("zan-dialog",{attrs:{id:"zan-base-dialog"}})],e.is_applying?i("v-uni-view",{staticClass:"dealer-boot dis-flex flex-dir-column flex-y-center"},[i("v-uni-view",{staticClass:"boot__msg f-30 dis-flex flex-dir-column flex-y-center"},[i("v-uni-text",{staticClass:"msg__icon iconfont icon-shenhezhong"}),i("v-uni-text",{staticClass:"msg__content m-top20 f-29 col-80"},[e._v(e._s(e.words.apply.words.wait_audit.value))])],1),i("v-uni-view",{staticClass:"boot__submit form-submit dis-flex flex-x-center"},[i("v-uni-form",{attrs:{"report-submit":"true"},on:{submit:function(t){arguments[0]=t=e.$handleEvent(t),e.navigationToIndex.apply(void 0,arguments)}}},[i("v-uni-button",{attrs:{formType:"submit"}},[e._v(e._s(e.words.apply.words.goto_mall.value))])],1)],1)],1):e._e()],2):e._e()},o=[]},acb6:function(e,t,i){"use strict";var a=i("c751"),n=i.n(a);n.a},c751:function(e,t,i){var a=i("d48b");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=i("4f06").default;n("36e915e1",a,!0,{sourceMap:!1,shadowMode:!1})},d48b:function(e,t,i){var a=i("24fb");t=a(!1),t.push([e.i,'uni-page-body[data-v-5540d17c]{background:#fff}.c-violet[data-v-5540d17c]{color:#786cff}.col-80[data-v-5540d17c]{color:grey}.col-bb[data-v-5540d17c]{color:#bbb}.f-38[data-v-5540d17c]{font-size:%?38?%}.dealer-bg uni-image[data-v-5540d17c]{display:block;width:100%}.widget-form[data-v-5540d17c]{width:%?700?%;box-sizing:border-box;box-shadow:0 %?1?% %?20?% rgba(0,0,0,.21);border-radius:%?12?%;margin-top:%?-80?%}.widget-form .form-title[data-v-5540d17c]{padding:0 %?40?%;height:%?90?%;line-height:%?90?%;border-bottom:%?1?% solid #e7e7e7}.widget-form .form-box[data-v-5540d17c]{padding:%?35?%}.widget-form .form-box .form-field[data-v-5540d17c]{height:%?80?%;margin-bottom:%?24?%;padding:%?10?% %?28?%;background-color:#f9f9f9;box-sizing:border-box;font-size:%?28?%}.widget-form .form-box .form-field.auto-height[data-v-5540d17c]{height:auto}.widget-form .form-box .form-field .field-label[data-v-5540d17c]{width:%?130?%;color:grey}.form-license .license-icon[data-v-5540d17c]{margin-right:%?12?%}.form-submit[data-v-5540d17c]{margin-top:%?40?%}.form-submit uni-button[data-v-5540d17c]{font-size:%?30?%;background:#786cff;border:%?1?% solid #786cff;color:#fff;border-radius:%?50?%;padding:0 %?120?%}.form-submit uni-button[disabled][data-v-5540d17c]{background:#8e84fc;border-color:#8e84fc;color:#fff}\r\n\r\n/* 等待审核 */.dealer-boot[data-v-5540d17c]{padding:%?10?% %?30?%;margin-top:%?80?%}.dealer-boot .msg__icon[data-v-5540d17c]{font-size:%?120?%;color:#8e84fc}.dealer-boot .boot__submit[data-v-5540d17c]{margin-top:%?60?%}.boot__submsg[data-v-5540d17c]{margin-top:%?30?%;font-size:%?28?%;color:#786cff;line-height:1.5}.boot__submsg .iconfont[data-v-5540d17c]{margin-right:%?6?%}.row-voucher[data-v-5540d17c]{padding:%?24?% %?20?%}.row-voucher .image-list[data-v-5540d17c]:after{clear:both;content:" ";display:table}.row-voucher .image-list uni-image[data-v-5540d17c]{display:block;width:%?150?%;height:%?150?%}.row-voucher .image-list .image-picker[data-v-5540d17c]{width:%?150?%;height:%?150?%;border:%?1?% dashed #ccc;color:#ccc}.row-voucher .image-list .image-picker .choose__icon[data-v-5540d17c]{font-size:%?56?%;margin-bottom:%?6?%}.row-voucher .image-list .image-picker .choose__text[data-v-5540d17c]{font-size:%?22?%}.row-voucher .image-list .image-picker[data-v-5540d17c], .image-list .image-preview[data-v-5540d17c]{margin:%?15?% %?30?% %?15?% 0;float:left}.row-voucher .image-list .image-picker[data-v-5540d17c]:nth-child(4n+0),\r\n  .row-voucher .image-list .image-preview[data-v-5540d17c]:nth-child(4n+0){margin-right:0}.row-voucher .image-list .image-preview[data-v-5540d17c]{position:relative}.row-voucher .image-list .image-preview .image-delete[data-v-5540d17c]{position:absolute;top:%?-15?%;right:%?-15?%;height:%?42?%;width:%?42?%;line-height:%?42?%;background:rgba(0,0,0,.64);border-radius:50%;color:#fff;font-weight:bolder;font-size:%?22?%;z-index:10;text-align:center}body.?%PAGE?%[data-v-5540d17c]{background:#fff}',""]),e.exports=t},e798:function(e,t,i){"use strict";i.r(t);var a=i("7db05"),n=i("30df");for(var o in n)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(o);i("acb6");var s,r=i("f0c5"),l=Object(r["a"])(n["default"],a["b"],a["c"],!1,null,"5540d17c",null,!1,a["a"],s);t["default"]=l.exports}}]);