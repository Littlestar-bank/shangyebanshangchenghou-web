(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-sharing-order-comment-comment"],{"317e":function(e,t,a){var o=a("cd06");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var i=a("4f06").default;i("30556f9c",o,!0,{sourceMap:!1,shadowMode:!1})},"3aad":function(e,t,a){"use strict";var o=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a("53ca")),s=o(a("ade3"));a("4160"),a("159b"),a("99af"),a("a434"),a("b64b"),a("1276"),a("ac1f");var n=getApp().globalData,r={components:{},props:{},data:function(){return{options:null,goodsList:[],formData:[]}},onLoad:function(e){this.options=e,this.getGoodsList()},methods:{getGoodsList:function(){var e=this;n._get("sharing.comment/order",{order_id:this.options.order_id},(function(t){var a=t.data.goodsList;e.setData({goodsList:a,formData:e.initFormData(a)})}))},initFormData:function(e){var t=[];return e.forEach((function(e){t.push({goods_id:e.goods_id,order_goods_id:e.order_goods_id,score:10,content:"",image_list:[],uploaded:[]})})),t},setScore:function(e){var t=e.currentTarget.dataset;this.setData((0,s.default)({},"formData."+t.index+".score",t.score))},contentInput:function(e){var t=e.currentTarget.dataset.index;this.setData((0,s.default)({},"formData."+t+".content",e.detail.value))},chooseImage:function(e){var t=this,a=e.currentTarget.dataset.index,o=t.formData[a].image_list;uni.chooseImage({count:6-o.length,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){t.setData((0,s.default)({},"formData."+a+".image_list",o.concat(e.tempFilePaths)))}})},deleteImage:function(e){var t=e.currentTarget.dataset,a=this.formData[t.index].image_list;a.splice(t.imageIndex,1),this.setData((0,s.default)({},"formData."+t.index+".image_list",a))},submit:function(){var e=this,t=e.formData;if(!0===e.submitDisable)return!1;e.submitDisable=!0,uni.showLoading({title:"正在处理...",mask:!0});var a=function(t){console.log("fromPostCall"),console.log(t),n._post_form("sharing.comment/order",{order_id:e.options.order_id,formData:JSON.stringify(t)},(function(e){1===e.code?n.showSuccess(e.msg,(function(){uni.navigateBack()})):n.showError(e.msg)}),!1,(function(){uni.hideLoading(),e.submitDisable=!1}))},o=0;t.forEach((function(e){""!==e.content&&(o+=e.image_list.length)})),o>0?e.uploadFile(o,t,a):a(t)},uploadFile:function(e,t,a){var o={wxapp_id:n.getWxappId(),token:uni.getStorageSync("token")},s=0;t.forEach((function(r){""!==r.content&&r.image_list.forEach((function(c,d){uni.uploadFile({url:n.api_root+"upload/image",filePath:c,name:"iFile",formData:o,success:function(e){var t="object"===(0,i.default)(e.data)?e.data:JSON.parse(e.data);1===t.code&&(r.uploaded[d]=t.data.file_id)},complete:function(){s++,e===s&&(console.log("upload complete"),a&&a(t))}})}))}))},setData:function(e){var t,a,o=this,i=[];Object.keys(e).forEach((function(s){i=s.split("."),t=e[s],a=o.$data,i.forEach((function(e,s){console.log(e),s+1===i.length?o.$set(a,e,t):a[e]||o.$set(a,e,{}),a=a[e]}))}))}}};t.default=r},6644:function(e,t,a){"use strict";a.r(t);var o=a("3aad"),i=a.n(o);for(var s in o)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return o[e]}))}(s);t["default"]=i.a},"6ef7":function(e,t,a){"use strict";a.r(t);var o=a("af5d"),i=a("6644");for(var s in i)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(s);a("c67a");var n,r=a("f0c5"),c=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,"4528da48",null,!1,o["a"],n);t["default"]=c.exports},af5d:function(e,t,a){"use strict";var o;a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return o}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.goodsList.length&&e.formData.length?a("v-uni-view",{staticClass:"container p-bottom"},[a("v-uni-view",{staticClass:"goods-list"},e._l(e.goodsList,(function(t,o){return a("v-uni-view",{key:o,staticClass:"goods-item"},[a("v-uni-view",{staticClass:"goods-detail dis-flex flex-dir-row"},[a("v-uni-view",{staticClass:"left"},[a("v-uni-image",{staticClass:"goods-image",attrs:{src:t.image.file_path}})],1),a("v-uni-view",{staticClass:"right dis-flex flex-box flex-dir-column flex-x-around"},[a("v-uni-text",{staticClass:"twolist-hidden"},[e._v(e._s(t.goods_name))]),a("v-uni-text",{},[e._v("￥"+e._s(t.goods_price))])],1)],1),a("v-uni-view",{staticClass:"score-row dis-flex flex-x-around"},[a("v-uni-view",{class:"score-item score__praise dis-flex flex-y-center flex-x-center "+(10==e.formData[o].score?"__active":""),attrs:{"data-index":o,"data-score":"10"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.setScore.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"score"},[a("v-uni-text",{staticClass:"score__icon iconfont icon-haoping"}),a("v-uni-text",{staticClass:"score__text"},[e._v("好评")])],1)],1),a("v-uni-view",{class:"score-item score__review dis-flex flex-y-center flex-x-center "+(20==e.formData[o].score?"__active":""),attrs:{"data-index":o,"data-score":"20"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.setScore.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"score"},[a("v-uni-text",{staticClass:"score__icon iconfont icon-zhongping"}),a("v-uni-text",{staticClass:"score__text"},[e._v("中评")])],1)],1),a("v-uni-view",{class:"score-item score__negative dis-flex flex-y-center flex-x-center "+(30==e.formData[o].score?"__active":""),attrs:{"data-index":o,"data-score":"30"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.setScore.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"score"},[a("v-uni-text",{staticClass:"score__icon iconfont icon-chaping"}),a("v-uni-text",{staticClass:"score__text"},[e._v("差评")])],1)],1)],1),a("v-uni-view",{staticClass:"dis-flex content-row"},[a("v-uni-textarea",{attrs:{"data-index":o,maxlength:"2000",placeholder:"请输入评价内容 (留空则不评价)",placeholderStyle:"color:#ccc"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.contentInput.apply(void 0,arguments)}}})],1),a("v-uni-view",{staticClass:"image-list"},[e._l(e.formData[o].image_list,(function(t,i){return a("v-uni-view",{key:i,staticClass:"image-preview"},[a("v-uni-text",{staticClass:"image-delete iconfont icon-shanchu",attrs:{"data-index":o,"data-image-index":i},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.deleteImage.apply(void 0,arguments)}}}),a("v-uni-image",{attrs:{mode:"aspectFill",src:t}})],1)})),!e.formData[o].image_list||e.formData[o].image_list.length<6?a("v-uni-view",{staticClass:"image-picker dis-flex flex-dir-column flex-x-center flex-y-center",attrs:{"data-index":o},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseImage.apply(void 0,arguments)}}},[a("v-uni-text",{staticClass:"choose__icon iconfont icon-tubiao_xiangji"}),a("v-uni-text",{staticClass:"choose__text"},[e._v("上传图片")])],1):e._e()],2)],1)})),1),a("v-uni-view",{staticClass:"flow-fixed-footer b-f"},[a("v-uni-view",{staticClass:"flow-btn f-32"},[a("v-uni-view",{on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v("确认提交")])],1)],1)],1):e._e()},s=[]},c67a:function(e,t,a){"use strict";var o=a("317e"),i=a.n(o);i.a},cd06:function(e,t,a){var o=a("24fb");t=o(!1),t.push([e.i,'.goods-list[data-v-4528da48]{border-top:%?1?% solid #e3e3e3;font-size:%?28?%}.goods-item[data-v-4528da48]{margin-bottom:%?30?%;border-bottom:%?1?% solid #e3e3e3;background:#fff}.goods-item .goods-detail[data-v-4528da48]{padding:%?24?% %?20?%}.goods-item .goods-detail .left .goods-image[data-v-4528da48]{display:block;width:%?150?%;height:%?150?%}.goods-item .goods-detail .right[data-v-4528da48]{padding-left:%?20?%}.goods-item .score-row[data-v-4528da48]{padding:%?24?% %?20?%}.goods-item .score-row .score-item.score__praise[data-v-4528da48]{color:#ff4544}.goods-item .score-row .score-item.score__praise .score__icon[data-v-4528da48]{background:#ff4544}.goods-item .score-row .score-item.score__review[data-v-4528da48]{color:#fcb500}.goods-item .score-row .score-item.score__review .score__icon[data-v-4528da48]{background:#fcb500}.goods-item .score-row .score-item.score__negative[data-v-4528da48]{color:#9b9b9b}.goods-item .score-row .score-item.score__negative .score__icon[data-v-4528da48]{background:#9b9b9b}.goods-item .score-row .score-item .score[data-v-4528da48]{padding:%?10?% %?20?% %?10?% %?10?%;border-radius:%?30?%}.goods-item .score-row .score-item .score .score__icon[data-v-4528da48]{margin-right:%?10?%;padding:%?10?%;border-radius:50%;font-size:%?30?%;color:#fff}.goods-item .score-row .score-item.__active .score[data-v-4528da48]{color:#fff}.goods-item .score-row .score-item.__active.score__praise .score[data-v-4528da48]{background:#ff4544}.goods-item .score-row .score-item.__active.score__review .score[data-v-4528da48]{background:#fcb500}.goods-item .score-row .score-item.__active.score__negative .score[data-v-4528da48]{background:#9b9b9b}.goods-item .content-row[data-v-4528da48]{padding:%?10?% %?20?%}.goods-item .content-row uni-textarea[data-v-4528da48]{width:100%;height:%?220?%;padding:%?12?%;border:%?1?% solid #e8e8e8;border-radius:%?5?%;box-sizing:border-box}.goods-item .image-list[data-v-4528da48]{padding:%?24?% %?20?%}.goods-item .image-list[data-v-4528da48]:after{clear:both;content:" ";display:table}.goods-item .image-list uni-image[data-v-4528da48]{display:block;width:%?150?%;height:%?150?%}.goods-item .image-list .image-picker[data-v-4528da48]{width:%?150?%;height:%?150?%;border:%?1?% dashed #ccc;color:#ccc}.goods-item .image-list .image-picker .choose__icon[data-v-4528da48]{font-size:%?56?%;margin-bottom:%?6?%}.goods-item .image-list .image-picker .choose__text[data-v-4528da48]{font-size:%?22?%}.goods-item .image-list .image-picker[data-v-4528da48], .goods-item .image-list .image-preview[data-v-4528da48]{margin-right:%?30?%;margin-top:%?30?%;float:left}.goods-item .image-list .image-picker[data-v-4528da48]:nth-child(4n+0), .goods-item .image-list .image-preview[data-v-4528da48]:nth-child(4n+0){margin-right:0}.goods-item .image-list .image-preview[data-v-4528da48]{position:relative}.goods-item .image-list .image-preview .image-delete[data-v-4528da48]{position:absolute;top:%?-15?%;right:%?-15?%;height:%?42?%;width:%?42?%;line-height:%?42?%;background:rgba(0,0,0,.64);border-radius:50%;color:#fff;font-weight:bolder;font-size:%?22?%;z-index:10;text-align:center}',""]),e.exports=t}}]);